<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Sven Co-op Manual :: Running a server (advanced topics)</title>

		<link rel="stylesheet" href="style.css" type="text/css">
		<link rel="icon" href="../game.ico" type="image/x-icon"/>

		<meta name="resource-type" content="document">
		<meta name="description" content="Sven Co-op Manual">
		<meta name="author" content="Sven Co-op Team">
		<meta name="distribution" content="global">
	</head>

	<body>
		<div id="header"><a id="top"></a><a href="index.html"><img src="images/header.png" alt="Sven Co-op Manual - Click here to jump to the index page"></a></div>
		<div id="navbar">Navigation &raquo; <a href="index.html">Index</a> &raquo; <a href="server-advanced.html">Running a server (advanced topics)</a></div>
		<div id="content">
			<h1>Running a server (advanced topics)</h1>

			<p>
				This section will go over some more advanced topics on running your server. <em>Do not try anything here that you do not understand!</em>
			</p>

			<h2>Contents</h2>

			<ol>
				<li><a href="#admins">Server administrators</a></li>
				<li><a href="#commands">Server commands</a></li>
				<li><a href="#cheats">Cheat commands</a></li>
				<li><a href="#multi-servers">Multiple servers on a single Sven Co-op install</a></li>
				<!--<li><a href="#system-service">Running a server as a system service</a></li>-->
				<li><a href="#webserver-apache">HTTP downloads for your Sven Co-op server content</a></li>
			</ol>

			<p class="back-to-top">
				<a href="#top">Back to the top...</a>
			</p>

			<a id="admins"></a><h2>Server administrators</h2>

			<p>
				Sven Co-op has a (minimal) framework for server administrators and owners to get some representation of their status and some basic functionality to help control the game session.
			</p>

			<p>
				These players are given this status by declaring their Steam ID within the file <em>adminsfile</em> (pointing to "<em>admins.txt</em>" by default). To give a player administrative status simply write their Steam ID on a line in this file. You can write comments after if you want to keep note of the players' handle.
			</p>

			<p>
				Server administrators will be shown as such on the score board with the icon <img class="icon" src="images/icons/server_admin.png" alt="Server administrator">. If the server is yours you can also denote yourself as such by placing an asterisk '<em>*</em>' before your Steam ID, for which you will get a tinted icon <img class="icon" src="images/icons/server_owner.png" alt="Server owner">. No additional functionality is currently available to owners, it's mainly for show.
			</p>

			<p>
				Here is an example of how your administrator list file could look:
			</p>

<pre>// Owners/operators
*STEAM_9:1:488201	# Paul (owner)
*STEAM_9:0:38195	# Jane

// Administrators
STEAM_9:0:95482		# Dave
STEAM_9:1:5828645	# Emily
STEAM_9:1:1522834	# sUpErDeAn
STEAM_9:0:864923	# Zamnuzi</pre>

			<p>
				You do not have to include your Steam ID if you are only going to be running a listen server (i.e. for a temporary map test session). As a player hosting a listen server, you are automatically given the ownership status.
			</p>

			<p>
				The only administrative functionality built-in currently provided is the ability to use <a href="#cheats">cheat commands</a>, primarily because this feature is fairly new to the game. We will be including more functionality in future releases, however our scripting platform is able to determine if a player is an administrator or owner. Anyone can write a server plug-in script to boost the functionality available without a complicated permissions base.
			</p>

			<p class="back-to-top">
				<a href="#top">Back to the top...</a>
			</p>

			<a id="commands"></a><h2>Server commands</h2>

			<p>
				Sven Co-op has server commands that can be used to manage servers better. Some of these are simply CVAR's you can change at run time, while others are pure commands.
			</p>

			<table>
				<tr>
					<th style="width: 125px;">Command</th>
					<th style="width: 125px;">Parameters</th>
					<th>Description</th>
				</tr>
				<tr>
					<td class="td1">kicksteamid</td>
					<td class="td2"><em>"Steam ID"</em></td>
					<td class="td1">Kicks a players based on their Steam ID case-insensitively. You must surround the Steam ID with quotes.</td>
				</tr>
				<tr>
					<td class="td1">mp_nextmap_cycle</td>
					<td class="td2"><em>Map name</em></td>
					<td class="td1">Sets the next map for the server. Players will see this in the score board only after their next respawn.</td>
				</tr>
			</table>

			<p class="back-to-top">
				<a href="#top">Back to the top...</a>
			</p>

			<a id="cheats"></a><h2>Cheat commands</h2>

			<p>
				The cheat commands built-in to Sven Co-op can only be used under certain conditions:
			</p>

			<ul>
				<li>If the server is for Internet players, it cannot have a maximum capacity of more than <em>3 players</em> -- LAN servers do not have this restriction.</li>
				<li>If CVAR "<em>sv_cheats</em>" is 1 anybody can use cheat commands.</li>
				<li>If CVAR "<em>sv_cheats</em>" is 2 only <a href="#admins">server administrators</a> can use cheats, and will not be subject to the server capacity restriction.</li>
				<li>If CVAR "<em>sv_cheats</em>" is 255 anybody can use engine diagnostic settings (such as <em>gl_wireframe</em>) even in a multi-player game.</li>
			</ul>

			<p>
				If a cheat command is attempted and these conditions are not met the player is told why, and the server will log this event (or print it in the console if logging is disabled).
			</p>

			<p>
				Cheat commands are useful for private testing sessions, particularly for map authors as they provide some useful controls and limited debugging capabilities. If this is for you we advise you check the provided file "<em>map_test.cfg</em>" as this contains a range of command aliases and bindings to help you do this.
			</p>

			<p>
				Here is a list of cheat commands currently available:
			</p>

			<table>
				<tr>
					<th style="width: 125px;">Command</th>
					<th style="width: 125px;">Parameters</th>
					<th>Description</th>
				</tr>
				<tr>
					<td class="tf" colspan="3">Basic modes</td>
				</tr>
				<tr>
					<td class="td1">godmode</td>
					<td class="td2"><em>0</em> = disable<br><em>1</em> = enable</td>
					<td class="td1">Enable or disable god mode.<br>You will be immune to all damage against your health, but not HEV battery. A map entity can still forcibly kill you, and the <em>kill</em> command will still function as normal.</td>
				</tr>
				<tr>
					<td class="td1">cl_noclip</td>
					<td class="td2"><em>0</em> = disable<br><em>1</em> = enable</td>
					<td class="td1">Enable or disable no-clipping mode.<br>You will be flying instead of walking, and can move through solid matter like a ghost. You will not be non-solid yourself though, meaning NPC's can still touch/damage you, and you will still interact with brush based triggers.</td>
				</tr>
				<tr>
					<td class="td1">cl_notarget</td>
					<td class="td2"><em>0</em> = disable<br><em>1</em> = enable</td>
					<td class="td1">Enable or disable non-targetable mode.<br>You will be completely invisible to all NPC's, though they can still hear you (they will try to find you), and can damage you by accident.</td>
				</tr>
				<tr>
					<td class="td1">cl_nonsolid</td>
					<td class="td2"><em>0</em> = disable<br><em>1</em> = enable</td>
					<td class="td1">Enable or disable non-solid mode.<br>You will become non-solid like a ghost, thus players, NPC's, and brushes can pass through you without touching/damaging you. If something moves inside you and stays there however, you will be unable to move away as that other object is still solid. You will also not take damage from solid type objects (bullets/blades/etc), but particle type damage (explosions/fire/freeze) will still hurt you.</td>
				</tr>
				<tr>
					<td class="tf" colspan="3">Equipment &amp; status</td>
				</tr>
				<tr>
					<td class="td1">give</td>
					<td class="td2"><em>Weapon/ammo/item name</em></td>
					<td class="td1">Give yourself some equipment (weapons, ammo, and items).<br>Names should reflect the entity name of the equipment, for example <em>weapon_shotgun</em>, <em>ammo_rpg</em>, or <em>item_longjump</em>. You cannot use this to obtain <em>item_inventory</em> based items, use the <em>trigger</em> command instead.<br>You can technically give yourself any entity (such as a monster), but be warned the effects can be anything from humorous to catastrophic.</td>
				</tr>
				<tr>
					<td class="td1">giveall<br>impulse 101</td>
					<td class="td2">N/A</td>
					<td class="td1">Give yourself every weapon in the game with some ammo for it. The minigun and shock rifle are omitted due to their exclusive usage constraint.</td>
				</tr>
				<tr>
					<td class="td1">givepoints</td>
					<td class="td2"><em>Number</em></td>
					<td class="td1">Give yourself score/points. You can use a negative value to deduct points.</td>
				</tr>
				<tr>
					<td class="td1">reviveme</td>
					<td class="td2">N/A</td>
					<td class="td1">Revive yourself if you've been killed. You will be revived with half health.</td>
				</tr>
				<tr>
					<td class="td1">healme</td>
					<td class="td2">N/A</td>
					<td class="td1">Fully restores your health.</td>
				</tr>
				<tr>
					<td class="td1">chargeme</td>
					<td class="td2">N/A</td>
					<td class="td1">Fully charges your HEV suit battery.</td>
				</tr>
				<tr>
					<td class="tf" colspan="3">Map testing/debugging</td>
				</tr>
				<tr>
					<td class="td1">teleport</td>
					<td class="td2">Co-ordinates as <em>X Y Z</em></td>
					<td class="td1">Teleport yourself to specific co-ordinates.</td>
				</tr>
				<tr>
					<td class="td1">trigger</td>
					<td class="td2"><em>Map entity name</em></td>
					<td class="td1">Trigger an entity in the map by its <em>target name</em>.<br>This is best avoided for all but map authors, or those with good knowledge of the map in question. You as an entity will be passed to that entity as its activating and calling entity.</td>
				</tr>
			</table>

			<p class="back-to-top">
				<a href="#top">Back to the top...</a>
			</p>

			<a id="multi-servers"></a><h2>Multiple servers on a single Sven Co-op install</h2>

			<p>
				You do not have to have multiple installations of Sven Co-op or Sven Co-op Dedicated Server in order to run multiple game server processes. A single installation can hold multiple configurations, and a set of command line parameters can determine which set to use.
			</p>

			<p>
				This comes with some pros and cons.
			</p>

			<table>
				<tr>
					<th style="width: 50%;">Advantages</th>
					<th style="width: 50%;">Disadvantages</th>
				</tr>
				<tr>
					<td class="td1"><ul>
						<li>Less time spent installing and maintaining multiple copies of your server.</li>
						<li>Less time spent installing and maintaining custom content (i.e. map packs)</li>
						<li>Less disk space consumed due to only needing a single set of game files.</li>
						<li>Less effort required modifying/repairing game files (ripent, etc)</li>
						<li>Each process can choose to use a specific or shared configuration file.</li>
					</ul></td>
					<td class="td2"><ul>
						<li>Inability for processes to have the same map with different entities (ripent)<br><i>3rd party entity plug-ins like <em>entmod</em> can enable this</i></li>
						<li>Inability to limit a process to a specific set of game files.</li>
						<li>Not always suitable for different people/groups to run servers on the same machine, targeted for one person/group.</li>
						<li>Configurations must be within the game folder<br><i>Setting permissions can become annoying doing it all manually</i></li>
					</ul></td>
				</tr>
			</table>

			<p>
				Multi-server configuration is intended for people who want to run multiple game server processes of the same game on a single computer (maybe a large server with many processors) without the hassle of multiple installations. This is very common on game service providers or large clans/guilds.
			</p>

			<p>
				Fortunately, multi-server configuration is very simple and pretty well implemented -- for 1998. First, navigate to the <em>svencoop</em> folder on your server installation. There will be a folder called <em>servers</em> already. Any files you place in this folder are intended to be shared among all game server processes. Create a sub-folder for each game server process you want to have. There is no limit to how many you can have.
			</p>

			<p>
				There is already an example set of shared configuration files and a server specific configuration set for you to work from. Start by cloning the <em>example</em> folder.
			</p>

			<p>
				This diagram shows how your server configurations should be laid out.
			</p>

			<img class="diagram" src="images/multi-server-config-structure.png" alt="Example profiling folder structure" />

			<p>
				You can actually organise your configurations however you like, but this example is a good way of keeping them tidy.
			</p>

			<p>
				Each configuration folder will then have it's own set of <a href="server-config.html#config-files">configuration files</a> inside. You don't have to use all of them, but a unique <em>servercfgfile</em> is pretty much essential. A <em>logs</em> folder will also be needed if you ever intend on using the log files again.
			</p>

			<p>
				If you intend on using both a server specific and shared file (i.e. <em>banned.cfg</em>) you must use your server-specific <em>servercfgfile</em> to execute each file. You will generally want to execute the shared one first, then the server specific one after. Only configuration files (<em>.cfg</em>) can be shared or bequeathed.
			</p>

			<p>
				Next all you have to do is sort out your command line parameters to use the profiles you've created. This is very easy to do when running your server as unattended services either manually created or through FireDaemon, ServerDoc, or mEAn Loader. Otherwise make a new file "<em>start.cmd</em>" or "<em>start.sh</em>" in the server's configuration folder and put the command in here instead.
			</p>

			<p>
				Here are some examples of command line parameters that go after <em>svends.exe</em> (Windows) or <em>./svends_run</em> (Linux). You must change the working directory to the game server root first.
			</p>

			<ul class="simple code">
				<li>-console -port 27015 +maxplayers 12 +servercfgfile "servers/classic_cycle/server.cfg" +logsdir "servers/classic_cycle/logs" +map _server_start +log on<br></li>
				<li>-console -port 27025 +maxplayers 12 +servercfgfile "servers/custom_cycle/server.cfg"  +logsdir "servers/custom_cycle/logs" +map _server_start +log on<br></li>
				<li>-console -port 27035 +maxplayers 12 +servercfgfile "servers/fun_cycle/server.cfg"     +logsdir "servers/fun_cycle/logs" +map _server_start +log on<br></li>
				<li>-console -port 27045 +maxplayers 6 +servercfgfile "servers/private_test/server.cfg"  +logsdir "servers/private_test/logs" +map _server_start +log on<br></li>
			</ul>

			<p>
				You can also profile other common files such as Metamod's plug-in list (<em>plugins.ini</em>) and AMX mod X's configuration (<em>core.ini</em>). This can be done by adding the following parameters:
			</p>

			<ul class="simple code">
				<li>+localinfo mm_pluginsfile "servers/yourprofile/metamod-plugins.ini"</li>
				<li>+localinfo amxx_cfg "servers/yourprofile/amxx-core.ini"</li>
			</ul>

			<p>
				You can then point your AMXX configuration files in the <em>amxx-core.ini</em> to files that sit within your profile folder.
			</p>

			<p>
				Hopefully you can now understand how multi-server configuration an installation can really help, and how easy it is to set up.
			</p>

			<p class="back-to-top">
				<a href="#top">Back to the top...</a>
			</p>

			<!--<a id="system-service"></a><h2>Running a server as a system service</h2>

			<p class="back-to-top">
				<a href="#top">Back to the top...</a>
			</p>-->

			<a id="webserver-apache"></a><h2>HTTP downloads for your Sven Co-op server content</h2>

			<ul class="notes">
				<li><img class="note" src="images/icon-warning.png" alt="Warning"> This is implemented outside of our game and are provided only as advice. Therefore, we cannot provide any official support for them. Any help you require should be posted in our <a target="_blank" href="http://www.svencoop.com/forums/forumdisplay.php?f=39">server support forum</a> <img class="icon" src="images/link-external.png" alt="External Link" />, where you <em>may</em> receive assistance from our community.</li>
			</ul>

			<p>
				If you have a server with a very fast Internet connection or on a local area network, then providing fast downloads through HTTP is a must have. A common solution people take is uploading all their custom content to a web host or another location on the same computer. However, like the multi-server configuration advice above, this wastes disk space by duplicating content.
			</p>

			<p>
				Here I will show you how to set up an Apache web server that serves the same set of files from your single Sven Co-op installation, without leaking your configuration files and logs (which include passwords). The configuration I provide will also allow you to run a regular website off the same Apache instance.
			</p>

			<p>
				First visit the <a href="http://www.apache.org/">Apache Software Foundation</a>, download Apache HTTP Server (I'm working with version 2.2.15 for this guide), and install it.
			</p>

			<p>
				Navigate to your Apache configuration folder (usually at <em>C:\Program Files\Apache Software Foundation\Apache2.2\conf</em>), and open <em>httpd.conf</em> in a text editor.
			</p>

			<p>
				Here is a similar (but censored/stripped) copy of my configuration. You will need to replace values that are surrounded with curly brackets <em>{ }</em> to relate to your server. Obviously ensure you remove the brackets.
			</p>

			<ul>
				<li><img src="images/resource.png" alt="Resource" title="Resource"> <a href="resources/webserver-apache-httpd-conf.txt">httpd.conf</a></li>
			</ul>

			<p>
				Once you've done that, create a new file called <em>httpd-websites.conf</em> in the <em>conf</em> folder. This is where you will define each website that your Apache will host, including Sven Co-op content. The following example includes a regular website and a file pool for any game on your server.
			</p>

			<ul>
				<li><img src="images/resource.png" alt="Resource" title="Resource"> <a href="resources/webserver-apache-httpd-websites-conf.txt">httpd-websites.conf</a></li>
			</ul>

			<p>
				The key things to note about this example configuration is:
			</p>

			<ul>
				<li>Each site must operate off a different sub-domain (i.e. <em>www.some.host</em> and <em>svencoop.some.host</em>), or you could change to address-based virtual hosts where each site is defined by a different IP address and/or port.</li>
				<li>Like <a href="#multi-servers">configuration profiles</a>, you still only need Sven Co-op installed once to save time and disk space.</li>
				<li>Only files within sub-folders <em>gfx</em>, <em>maps</em>, <em>models</em>, <em>recommended_sounds</em>, <em>sound</em>, <em>sounds</em>, and <em>sprites</em> inside game folders will be permitted.</li>
				<li><em>WAD</em> files are also permitted within mod folders.</li>
				<li>Your configuration files (profiled or not) and logs will be denied.</li>
			</ul>

			<p>
				You will need to restart the Apache HTTPD service for configuration changes to take effect. Finally, set your <em>sv_downloadurl</em> to your website with the mod folder (i.e. <em>http://svends.computername/svencoop/</em> for sub-domain based or <em>http://192.168.0.1:8000/svencoop/</em> for address/port based) -- the trailing forward slash <em>/</em> is important.
			</p>

			<ul class="notes">
				<li><img class="note" src="images/icon-tip.png" alt="Tip"> If you do not have a domain name and do not wish to use your IP address in your <em>sv_downloadurl</em> (perhaps because it's dynamic), you can get a dynamic hostname for free from many <a href="http://www.google.com/search?q=dynamic+dns+provider">dynamic DNS providers</a> that can be mapped to your server for both the game server and web server.</li>
			</ul>

			<p class="back-to-top">
				<a href="#top">Back to the top...</a>
			</p>
		</div>
		<div id="footer"><small>&copy; Copyright Sven Co-op Team 2008. All rights reserved. Manual built by Adam "Adambean" Reece, content contributed and corrected by the Sven Co-op Team. Pages validated for strict HTML 4.01 and CSS 2.0.</small></div>
	</body>
</html>
